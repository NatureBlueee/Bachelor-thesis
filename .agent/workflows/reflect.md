---
description: 对话后提取记忆点，智能判断什么值得记录
---

# /reflect 工作流

## 用途

在一段讨论结束后调用，让 AI 回顾对话内容，自动提取值得记住的信息，解决"记忆不灵敏"问题。

## 设计原则

> **重要**：/reflect 不是"执行器"，而是"评估器+执行器"。
> 即使用户发起了此工作流，也要先判断"值不值得记忆"。
> "无需记忆"是完全合理的结论——不是每次对话都有值得记的东西。

## 触发时机

用户可能在以下情况后调用：

1. 一次有深度的讨论结束
2. 做出重要决策
3. 发现新的洞见
4. 用户纠正了 AI 的假设
5. 讨论涉及用户偏好或工作方式
6. 或者只是不确定有没有值得记的

## 执行步骤

### 0. 评估是否有值得记忆的内容（必做）

先快速扫描刚才的对话，回答：**这次对话有什么值得长期记住的吗？**

**如果没有**（以下情况都不值得记）：
- 只是简单的问答
- 信息是临时的、一次性的
- 已经在规则或文档里明确的内容
- 纯粹的执行操作（如"帮我改个格式"）

输出：

```markdown
## 记忆评估结果

**结论**：无需记忆

**原因**：本次对话主要是{{简述内容}}，没有发现需要长期记住的偏好、决策或洞见。
```

然后**停止**，不执行后续步骤。

**如果有值得记忆的内容**，继续执行后续步骤。

### 1. 回顾对话

回顾刚才的对话，用以下维度分析：

```markdown
## 记忆提取分析

### A. 用户偏好
- 是否表达了偏好？（"我喜欢...", "我不想...", "我习惯..."）
- 具体内容：{{如有}}

### B. 决策记录
- 是否做出了重要决策？
- 决策内容：{{如有}}
- 决策理由：{{如有}}

### C. 洞见发现
- 是否形成了新的认识或洞见？
- 具体内容：{{如有}}

### D. 纠正记录
- 用户是否纠正了 AI 的假设？
- 原假设：{{如有}}
- 正确理解：{{如有}}

### E. 工作方式
- 是否涉及工作流程或习惯？
- 具体内容：{{如有}}

### F. 重要约束
- 是否有必须遵守的约束条件？
- 具体内容：{{如有}}
```

### 2. 判断是否值得记录

**值得记录的标准**（满足任一即可）：

| 类型 | 判断标准 | 示例 |
|------|---------|------|
| 偏好 | 会影响未来的交互方式 | "我希望你批判性地质疑" |
| 决策 | 会影响后续工作方向 | "决定用定性研究而非混合方法" |
| 洞见 | 有普适价值或需要反复使用 | "Z世代的尊重=被倾听" |
| 纠正 | 防止再犯同样的错误 | "不是AI威胁论，是资源赋能" |
| 约束 | 硬性限制 | "必须用英文写论文正文" |

**不值得记录的**：
- 一次性的问答（下次不会再问）
- 已经在规则里明确的内容
- 临时的调试信息

### 3. 格式化记忆内容

如果判断值得记录，按以下格式准备：

```markdown
### {{日期}} - {{简短标题}}

**类型**：偏好/决策/洞见/纠正/约束

**内容**：
{{1-3句话概括核心内容}}

**上下文**：
{{为什么会产生这个记忆，可选}}

**相关**：{{关联的 PR/CON/文献，可选}}
```

### 4. 更新 MEMORY.md

将提取的记忆追加到 `MEMORY.md` 的对应分区：

```markdown
# MEMORY.md

> **最后更新**：{{当前日期}}  ← 同时更新这里！

## 用户偏好
{{追加新的偏好}}

## 关键洞见
{{追加新的洞见}}

## 决策记录
{{追加新的决策}}

## 待验证假设
{{如果是假设而非确认}}
```

### 5. 输出提取报告

完成后输出：

```markdown
## 记忆提取完成

**本次提取**：
- ✅ 偏好 x1：{{简述}}
- ✅ 洞见 x1：{{简述}}
- ⏭️ 决策：无新决策

**已更新**：
- MEMORY.md（标题日期 + 内容）

**建议**：
- {{如有后续建议}}
```

---

## 记忆提取 Prompt 模板

> 借鉴自 Mem0 的 MEMORY_DEDUCTION_PROMPT

```
你是一个记忆提取专家。请分析以下对话，提取值得长期记住的信息。

关注以下类型：
1. 用户表达的偏好和习惯
2. 做出的重要决策及理由
3. 形成的新洞见或认识
4. 用户对你假设的纠正
5. 必须遵守的约束条件

不要提取：
- 一次性的问答
- 临时信息
- 已经明确在规则中的内容

对于每个提取的记忆，说明：
- 类型
- 内容（简洁）
- 是否需要与现有记忆合并或更新

对话内容：
{{对话}}
```

---

## 注意事项

1. **不是每次对话都要调用**：只在"有价值"的讨论后调用
2. **宁缺毋滥**：只记重要的，避免记忆污染
3. **去重和合并**：如果新记忆与旧记忆相似，考虑合并而非追加
4. **标题日期必更新**：每次修改 MEMORY.md 都要更新顶部日期
5. **可以主动建议**：AI 发现值得记录的内容时，可以主动提议调用此工作流
